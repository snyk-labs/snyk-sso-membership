# ユーザーノート

## プロジェクト概要

このプロジェクトは、**Go言語**で書かれた**Snyk SSO Membership Tool**というコマンドラインインターフェース（CLI）ツールです。

主な目的は、**Snykのグループ管理者**がシングルサインオン（SSO）の移行作業中に、ユーザーアカウントの管理を支援することです。企業がSSOプロバイダーやメールドメインを変更する際（例：`user@company.com` から `user@new-company.com`へ）、このツールはユーザーの権限やメンバーシップを古いアカウントから新しいアカウントへ簡単に移行させることができます。

## 主な機能

このツールには3つの主要なコマンドがあります。

1.  `sync`: これが中心的な機能です。ユーザーのグループおよびオーガニゼーションのメンバーシップを、移行元のアカウント（例：`user@source.com`）から移行先のアカウント（例：`user@destination.com`）へコピーします。これにより、ユーザーが新しいIDでログインした際に、以前と同じアクセス権を持つことが保証されます。
2.  `get-users`: SnykグループのSSO接続に関連付けられている全ユーザーのリストを取得・表示します。これは、移行対象のユーザーを監査したり、リストを作成したりするのに役立ちます。
3.  `delete-users`: 管理者がSnykグループからユーザーをまとめて削除することができます。移行完了後に古いアカウントを整理する際に必要となります。

## 動作の仕組み

このツールは、**Snyk API**と直接やり取りをしてこれらの操作を実行します。「グループ管理者」の権限を持つSnyk APIトークンを管理者が提供する必要があり、ツールはこのトークンを使って認証を行い、ユーザーリストの取得、オーガニゼーションメンバーシップの更新、ユーザーの削除といった認可されたAPI呼び出しを実行します。

## プロジェクト構成

コードは、標準的なGoプロジェクトのレイアウト規則に従って整理されています。

*   `/cmd`: アプリケーションのメインエントリーポイントが含まれています。プログラムはここから開始され、コマンドライン引数（`sync`, `get-users`など）を解釈し、適切な関数を呼び出します。
*   `/internal`: 各コマンドのコアとなるビジネスロジックが格納されています。例えば、`internal/commands/sync.go`には、メンバーシップ同期プロセスを制御するコードが含まれています。ここのコードはこのアプリケーションに固有のものであり、他のプロジェクトでの再利用は意図されていません。
*   `/pkg`: 他のプロジェクトでも理論的に再利用可能なパッケージが含まれています。
    *   `/pkg/client`: Snyk APIと対話するためのクライアント。
    *   `/pkg/config`: アプリケーション設定を管理するためのコード。
    *   `/pkg/membership` & `/pkg/sso`: SnykのメンバーシップとSSOのデータ構造を扱うためのロジック。
*   `/test`: アプリケーションのテストに使用されるモックが含まれています。

要約すると、これはSnyk管理者がSSOの変更時に直面する、特定の複雑な問題を解決するために作られた専用のユーティリティです。
